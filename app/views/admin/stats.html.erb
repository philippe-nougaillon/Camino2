<div>
  <h1 class="font-bold text-4xl mb-6">Admin</h1>

  <div class='overflow-x-auto mt-6'>
    <table class='table'>
      <thead>
        <tr>
          <th>Account</th>
          <th>User email</th>
          <th>Dernière Connexion</th>
          <th>Nbr</th>
          <th>Projets</th>
          <th>Lignes</th>
          <th>Modifié le</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% @accounts.uniq.each do |account| %>
          <% account.users.each do |user| %>
            <% total_lignes = account_infos(account) %>
            <tr>
              <td><%= account.name %></td>
              <td><%= user.email %></td>
              <td><%= time_ago_in_words user.last_sign_in_at if user.sign_in_count.positive? %></td>
              <td class=" <%= user.sign_in_count > 1 ? 'text-info font-black' : ''  %>"><%= user.sign_in_count %></td>
              <% if account.users.first == user %>
                <td class=<%= 'text-info' if account.projects.count > 1 %>><%= account.projects.count %></td>
                <td class=<%= 'text-info' if total_lignes > 32 %>><%= total_lignes %></td>
                <td><%= time_ago_in_words user.updated_at %></td>
                <td><%= link_to "[X]", admin_suppression_compte_path(account:), class:"btn btn-ghost btn-sm" %></td>
              <% else %>
                <td colspan=2></td>
                <td><%= time_ago_in_words user.updated_at %></td>
                <td></td>
              <% end %>
              
            </tr>
          <% end %>
          <tr></tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <span><%= page_entries_info @accounts, entry_name: 'user' %></span>
  <%= paginate @accounts %>


</div>
