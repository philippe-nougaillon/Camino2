<%= form_for(@todo, multipart: true) do |f| %>
  <% if @todo.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@todo.errors.count, "error") %> prohibited this todo from being saved:</h2>

      <ul>
      <% @todo.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="p-2 shadow">
    <div class="field">
      <%= f.hidden_field :todolist_id %>
    </div>
    <div class="field">
      <%= f.check_box :done, title:'Cochée = Terminée', class: 'checkbox mb-4 mr-10' %>
      <%= f.text_field :name, class: 'input input-bordered w-96 mb-4', required: true %>

      <%= f.label :user_id, 'Assigné à :' %>
      <%= f.select :user_id, 
                    options_from_collection_for_select(@project.users.order(:name), "id", "name", @todo.user_id),
                    { include_blank: true },
                    { class: 'select select-bordered select-sm', required: true } %>

      <%= f.label :notify, "notifier ?" %>
      <%= f.check_box :notify, class: 'checkbox' %>
    </div>
    <div class="ml-16">
      <div class="field">
        <%= f.label 'Echéance :' %>
        <%= f.date_field :duedate, size:5, value:(@todo.duedate ? @todo.duedate : nil), class: 'input input-bordered mt-4' %>

        <small class="block mt-4 sm:mt-0">Cette échéance va s'ajouter au calendrier du participant assigné et un rappel lui sera envoyé à J-
          <%= f.select :notifydays, options_for_select((1..10), @todo.notifydays.to_s), {}, { class:'select select-xs select-bordered' } %>
        </small>
        <br>

        <%= f.label "Document :" %>
        <%= f.file_field :doc, class:"mb-4 sm:mb-0" %>

        <%= f.label 'Tags :' %>
        <%= f.text_field :tag_list, value:@todo.tag_list.join(", "), class: 'input input-bordered input-sm' %>
      </div>

      <% if @table %>
        <%= link_to "Ajouter des données dans #{@table.name}", fill_url(@table.id, todo_id:@todo), class: 'link' %>
        <br>
      <% end %>
      <br>

      <div class="actions">
        <%= f.submit @todo.new_record? ? "Ajouter" : "Enregistrer", class: 'btn btn-active btn-ghost' %> 
      </div>
    </div>
  </div>

<% end %>
